---
import { type CollectionEntry, getCollection } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Navbar from '@/components/Navbar.astro';
import Footer from '@/components/Footer.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={post.data.title} description={post.data.description} image={post.data.heroImage}>
  <Navbar />
  
  <article class="pt-24 pb-16">
    <div class="container-custom max-w-4xl">
      <div class="mb-12 text-center">
        <div class="inline-block text-primary font-medium mb-4">
          {post.data.pubDate.toLocaleDateString('en-us', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
          })}
        </div>
        <h1 class="text-4xl md:text-6xl font-bold mb-8 leading-tight">{post.data.title}</h1>
        <div class="flex items-center justify-center gap-4">
          <img src={`https://i.pravatar.cc/150?u=${post.data.author}`} alt={post.data.author} class="w-10 h-10 rounded-full" />
          <div class="text-left font-medium">
            <div>{post.data.author}</div>
            <div class="text-xs text-muted-foreground uppercase tracking-widest">Editor</div>
          </div>
        </div>
      </div>
      
      {post.data.heroImage && (
        <div class="aspect-[21/9] rounded-3xl overflow-hidden mb-16 shadow-2xl">
          <img src={post.data.heroImage} alt="" class="w-full h-full object-cover" />
        </div>
      )}
      
      <div class="prose prose-lg dark:prose-invert max-w-none prose-headings:font-bold prose-a:text-primary prose-img:rounded-2xl">
        <Content />
      </div>
      
      <div class="mt-20 pt-8 border-t border-border flex items-center justify-between">
         <a href="/blog" class="flex items-center gap-2 text-primary font-medium hover:underline">
           <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
           Back to Blog
         </a>
         <div class="flex gap-4">
           <!-- Social Share -->
           <p class="text-sm text-muted-foreground font-medium">Share:</p>
           <div class="flex gap-4 text-muted-foreground">
             <a href="#" class="hover:text-primary transition-colors cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path></svg></a>
             <a href="#" class="hover:text-primary transition-colors cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
           </div>
         </div>
      </div>
    </div>
  </article>
  
  <Footer />
</BaseLayout>
